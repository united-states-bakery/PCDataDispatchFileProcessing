<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="2/21/2020 9:28:13 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="LAP23588"
  DTS:CreatorName="USBAKERY\cardonp-admin"
  DTS:DTSID="{731989B5-BBF8-4592-9A6A-9507D2877A8C}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:FailParentOnFailure="True"
  DTS:LastModifiedProductVersion="15.0.2000.170"
  DTS:LocaleID="1033"
  DTS:ObjectName="PCData_Route_GetDispatchedOrders_v6"
  DTS:PackageType="5"
  DTS:VersionBuild="317"
  DTS:VersionGUID="{A89C28DE-A8AC-4893-BD89-23222AAA0620}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[SMTP Connection Manager]"
      DTS:CreationName="SMTP"
      DTS:DTSID="{710979CD-AC2F-4F05-9D13-F7EE02B86A87}"
      DTS:ObjectName="SMTP Connection Manager">
      <DTS:ObjectData>
        <SmtpConnectionManager
          ConnectionString="SmtpServer=SRVRMAIL100.CORP.USBAKERY.COM;UseWindowsAuthentication=True;EnableSsl=False;"
          ConnectByProxy="False" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[USB-Support]"
      DTS:CreationName="OLEDB"
      DTS:DelayValidation="True"
      DTS:DTSID="{8914C185-EC6E-4AB3-B9F1-DEF1E51955D2}"
      DTS:ObjectName="USB-Support">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[User::DB_Support_Database]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[User::DB_Support_Server]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=testnav120;Initial Catalog=USB-Support;Provider=MSOLEDBSQL;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{2559D768-6FD5-4798-A499-ED541141BAE5}"
      DTS:ObjectName="AfterHoursSupport">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">franz.support@usbakery.com</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:Description="Either PROD, UAT, or DEV"
      DTS:DTSID="{E5BF2E5B-9585-4862-AA23-25942F8365C4}"
      DTS:ObjectName="DebugMode">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">UAT</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:Description="Directory where the Dispatch files reside"
      DTS:DTSID="{557CDFD0-5B27-4222-B0B4-807D6D9E7F7A}"
      DTS:ObjectName="ImportDirectory">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">\\srvrmanage224\Transfers\PutToLight-PCDATA_TEST\Inbound\</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:Description="use the format yyyy-mm-dd or x for the current order date"
      DTS:DTSID="{048D9930-D5FA-472B-82AB-CD6EF91EC1C3}"
      DTS:ObjectName="OrderDate">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">x</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:Description="Enter a Regional Bakery Code, or x for ALL Active Bakeries"
      DTS:DTSID="{A0F2E9C3-77DE-4C90-B2F8-5F5B8EBB2603}"
      DTS:ObjectName="RegionalBakery">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">x</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{247E316C-770D-40F4-990C-562D177EEE9C}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::ImportDirectory]  + &quot;Archive\\&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ArchiveDirectory">
      <DTS:VariableValue
        DTS:DataType="8">\\srvrmanage224\Transfers\PutToLight-PCDATA_TEST\Inbound\Archive\</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C5473FBE-8988-4236-A0AE-5DF532CAAAB3}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::ArchiveDirectory] +  @[User::DispatchFilename] + &quot;-&quot; + @[User::ProcessStatus]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="BadFileDestination">
      <DTS:VariableValue
        DTS:DataType="8">\\srvrmanage224\Transfers\PutToLight-PCDATA_TEST\Inbound\Archive\20240130_1_1_BIL-MIDLND.OD0-Skipped</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F9F3FE01-A67A-4CA3-B585-701979F02223}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::ProcessDirectory] +  @[User::DispatchFilename]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="BadFileSource">
      <DTS:VariableValue
        DTS:DataType="8">\\srvrmanage224\Transfers\PutToLight-PCDATA_TEST\Inbound\Processing\20240130_1_1_BIL-MIDLND.OD0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{58CB9B30-8930-4769-99A4-8F49CDEAA3FE}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="UPPER(@[User::DebugMode]) == &quot;PROD&quot; ? &quot;USB-Support&quot; : &quot;USB-Support&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DB_Support_Database">
      <DTS:VariableValue
        DTS:DataType="8">USB-Support</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{0E0C0408-3BF0-4A11-AA27-9259FFD8ACF3}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="UPPER(@[User::DebugMode]) == &quot;PROD&quot; ? &quot;srvrnav110&quot; : &quot;testnav120&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DB_Support_Server">
      <DTS:VariableValue
        DTS:DataType="8">testnav120</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{254EA0B6-6FDF-4739-97F6-1A36F1CCFC25}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="UPPER(@[$Package::DebugMode])"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DebugMode">
      <DTS:VariableValue
        DTS:DataType="8">UAT</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CFFFBC63-63E3-4CF0-927B-BA9CFA13FF18}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DispatchFilename">
      <DTS:VariableValue
        DTS:DataType="8">20240130_1_1_BIL-MIDLND.OD0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3E023EEA-CA54-464B-9299-D4E714BFA14D}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DispatchOrderDate">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{84AFA3C2-4BEC-4E1B-AEBF-0D52207F3C3B}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DispatchStatus">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{66BC02A0-2958-44A3-81E6-6A2D82E89812}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="DivisionAdminCnt">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{EF2DAD48-7794-4E73-933A-EA6840966643}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;*** URGENT ***  The Shipping Dispatch File for &quot; + @[User::Region] + &quot; has not been Received by 10PM Pacific time.  The Shipping Adjustments needed for the Sales Handhelds will not get the correct information.&#xA;&#xA;Contact US Bakery Immediately.&#xA;&#xA;This is an Automated message from an SSIS Scheduled Job for &quot; +  @[System::PackageName] + &quot; on server &quot; +  @[System::MachineName]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="EmailLateBody">
      <DTS:VariableValue
        DTS:DataType="8">*** URGENT ***  The Shipping Dispatch File for POR-DAVIS has not been Received by 10PM Pacific time.  The Shipping Adjustments needed for the Sales Handhelds will not get the correct information.

Contact US Bakery Immediately.

This is an Automated message from an SSIS Scheduled Job for PCData_Route_GetDispatchedOrders_v6 on server LAP31893</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{1A92FADE-493B-4D7C-9D15-0732F7EB9B95}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;CRITICAL: Shipping Dispatch File LATE for &quot; + @[User::Region]  + &quot; - This Affects US Bakery Handheld Downloads&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="EmailLateSubject">
      <DTS:VariableValue
        DTS:DataType="8">CRITICAL: Shipping Dispatch File LATE for POR-DAVIS - This Affects US Bakery Handheld Downloads</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{220D77CA-F415-439D-8098-28E07C045068}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;A PCData &quot; +  (DT_WSTR, 1) @[User::WaveType]+ &quot; wave dispatch file was sent from &quot; +  @[User::Region] + &quot;. This file has been has been ignored and no adjustments have been recorded in NAV. Please export a wave 1 file to correctly dispatch orders to NAV.&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="EmailSendErrorMsg">
      <DTS:VariableValue
        DTS:DataType="8">A PCData 0 wave dispatch file was sent from POR-DAVIS. This file has been has been ignored and no adjustments have been recorded in NAV. Please export a wave 1 file to correctly dispatch orders to NAV.</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4D4F5624-6DE2-4E36-898B-3C20D67E208A}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;Shipping Dispatch File &quot; + @[User::DispatchFilename] + &quot; has Imported for Bakery &quot; + @[User::Region] +  &quot;&#xA;&#xA;&lt;&quot; +  @[System::MachineName] + &quot;, Old_Handheld_Exports - ALL Divisions PROD, &quot; +  @[System::PackageName] + &quot;&gt;&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="EmailSuccessBody">
      <DTS:VariableValue
        DTS:DataType="8">Shipping Dispatch File 20240130_1_1_BIL-MIDLND.OD0 has Imported for Bakery POR-DAVIS

&lt;LAP31893, Old_Handheld_Exports - ALL Divisions PROD, PCData_Route_GetDispatchedOrders_v6&gt;</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{1C3F3535-B9AD-48D3-A734-7F485C6A7166}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;INFO - Business Systems - PC_DATA - Shipping Dispatch File Import for Bakery &quot; + @[User::Region]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="EmailSuccessSubject">
      <DTS:VariableValue
        DTS:DataType="8">INFO - Business Systems - PC_DATA - Shipping Dispatch File Import for Bakery POR-DAVIS</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B3F6D1C8-012A-4B0A-BE58-97E51C447322}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="UPPER(@[User::DebugMode]) == &quot;PROD&quot; ? @[$Package::AfterHoursSupport] : &quot;paul.cardon@usbakery.com;max.schneider@usbakery.com&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="EmailSuccessTo">
      <DTS:VariableValue
        DTS:DataType="8">paul.cardon@usbakery.com;max.schneider@usbakery.com</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A310CE58-572A-49DD-8B18-0FADF14CDA29}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="UPPER(@[User::DebugMode]) == &quot;PROD&quot; ? &quot;franz.cao@usbakery.com;NAV.Support@usbakery.com&quot; : &quot;paul.cardon@usbakery.com;max.schneider@usbakery.com&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="EmailWarningTo">
      <DTS:VariableValue
        DTS:DataType="8">paul.cardon@usbakery.com;max.schneider@usbakery.com</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{37108D72-3AF9-450B-A644-DC8622D0457F}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ErrorEmailBody">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{48E4570C-C3F9-46F2-B864-2F4BD85EA69F}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ErrorEmailCC">
      <DTS:VariableValue
        DTS:DataType="8">paul.cardon@usbakery.com;max.schneider@usbakery.com</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{DCD06B27-DBAF-4C16-89CD-A35F5BC57116}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ErrorEmailFrom">
      <DTS:VariableValue
        DTS:DataType="8">SSIS_Svc@usbakery.com</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4485D53B-92E7-41C0-9B23-802BEFD07352}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;CRITICAL: PC-Data Shipping Dispatch File Processing Failed - This Affects US Bakery Handheld Downloads&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ErrorEmailSubject">
      <DTS:VariableValue
        DTS:DataType="8">CRITICAL: PC-Data Shipping Dispatch File Processing Failed - This Affects US Bakery Handheld Downloads</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3AB92367-031F-4EBE-BE02-0D741DE040FE}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="UPPER(@[User::DebugMode]) == &quot;PROD&quot; ? &quot;franz.support@usbakery.com;franz.cao@usbakery.com;NAV.Support@usbakery.com;pendyala.venkatesh@marquam.com;mahesh.nadilla@marquam.com;paul.cardon@usbakery.com;max.schneider@usbakery.com&quot; : &quot;paul.cardon@usbakery.com;max.schneider@usbakery.com&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ErrorEmailTo">
      <DTS:VariableValue
        DTS:DataType="8">paul.cardon@usbakery.com;max.schneider@usbakery.com</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{6C6F4970-2B83-425A-8E3F-88DA57C2AE01}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::DebugMode] == &quot;PROD&quot; ?&quot;\\\\srvrmanage224\\transfers\\PutToLight-PCDATA\\Inbound\\&quot; :  &quot;\\\\srvrmanage224\\Transfers\\PutToLight-PCDATA_TEST\\Inbound\\&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ImportDirectory">
      <DTS:VariableValue
        DTS:DataType="8">\\srvrmanage224\Transfers\PutToLight-PCDATA_TEST\Inbound\</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{780AF421-EA40-456D-9144-BFF601483E56}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="ImportStatus">
      <DTS:VariableValue
        DTS:DataType="19">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E392578D-B0B2-4BC8-88C5-3C841BA8B95C}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="MoveFileLog">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A6B5DF0F-EC90-4197-9A1D-0F0A80767917}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="MoveSkippedFiles">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CCCF0D64-D1CC-4A2F-B9A4-CBE4917F09D9}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="FINDSTRING(&quot;-&quot;, @[$Package::OrderDate], 2 ) != 0 ?   @[$Package::OrderDate] : DATEPART(&quot;HH&quot;,getdate()) &lt; 15 ? LEFT((DT_STR, 30, 1252) GETDATE(),10) : LEFT((DT_STR, 30, 1252) DATEADD(&quot;DD&quot;, 1, GETDATE()),10)"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="OrderDate">
      <DTS:VariableValue
        DTS:DataType="8">2024-05-06</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A5CF80B4-073E-44DE-A10C-5CD621F8DE71}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="OrderDateCount">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E7D9FE4B-CE54-4BF1-A941-BA9BBB3B340D}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="OrderDateList">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{608F3055-5A4B-434D-8E51-21DB0934E494}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::ImportDirectory]  + &quot;Processing\\&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ProcessDirectory">
      <DTS:VariableValue
        DTS:DataType="8">\\srvrmanage224\Transfers\PutToLight-PCDATA_TEST\Inbound\Processing\</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{21FE208C-9B47-4A23-88BF-F4C02FCBFE31}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ProcessStatus">
      <DTS:VariableValue
        DTS:DataType="8">Skipped</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3796D7F5-7F59-4641-B93C-5C8992C6FA25}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Region">
      <DTS:VariableValue
        DTS:DataType="8">POR-DAVIS</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{2C7AEE87-4EA8-42F6-BD67-6C2F47AAA876}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="RegionList">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C0EB4974-9BD8-45B4-88C9-D36E9A781B16}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ShippingDate">
      <DTS:VariableValue
        DTS:DataType="8">2020-02-27</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{02019DDD-4087-4D48-BE09-61ACE7CDFE0C}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="ShippingEmail">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E491BE20-9905-4DD8-88F9-CBB10F736C9A}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SMTPServer">
      <DTS:VariableValue
        DTS:DataType="8">SRVRMAIL100.CORP.USBAKERY.COM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D4ABFD0E-0418-48C2-B35F-987C2D6B3336}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="WaveType">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\For Each Regional Bakery Move Dispatch Files"
      DTS:CreationName="STOCK:FOREACHLOOP"
      DTS:Description="Foreach Loop Container"
      DTS:DTSID="{41514240-6FEE-4A0D-824B-4BCEE49B9467}"
      DTS:ExecutableType="STOCK:FOREACHLOOP"
      DTS:LocaleID="-1"
      DTS:ObjectName="For Each Regional Bakery Move Dispatch Files">
      <DTS:ForEachEnumerator
        DTS:CreationName="Microsoft.ForEachADOEnumerator"
        DTS:DTSID="{F84796D8-11F5-4F8E-89FB-015E9725C7F8}"
        DTS:ObjectName="{F84796D8-11F5-4F8E-89FB-015E9725C7F8}">
        <DTS:ObjectData>
          <FEEADO
            EnumType="EnumerateRowsInFirstTable"
            VarName="User::RegionList" />
        </DTS:ObjectData>
      </DTS:ForEachEnumerator>
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\For Each Regional Bakery Move Dispatch Files\Move Wave or EOD File to Process"
          DTS:CreationName="Microsoft.ScriptTask"
          DTS:Description="Script Task"
          DTS:DTSID="{834CE914-1834-4B9B-9DFE-47DC19CECB74}"
          DTS:ExecutableType="Microsoft.ScriptTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Move Wave or EOD File to Process"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <ScriptProject
              Name="ST_28156e54ce1e4d0990e0426174693417"
              VSTAMajorVersion="15"
              VSTAMinorVersion="0"
              Language="CSharp"
              ReadOnlyVariables="User::ArchiveDirectory,User::ImportDirectory,User::OrderDate,User::ProcessDirectory,User::Region"
              ReadWriteVariables="User::MoveFileLog">
              <ProjectItem
                Name="Properties\AssemblyInfo.cs"
                Encoding="UTF8"><![CDATA[using System.Reflection;
using System.Runtime.CompilerServices;

//
// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
//
[assembly: AssemblyTitle("ST_28156e54ce1e4d0990e0426174693417")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("")]
[assembly: AssemblyProduct("ST_28156e54ce1e4d0990e0426174693417")]
[assembly: AssemblyCopyright("Copyright @  2023")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]
//
// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Revision and Build Numbers 
// by using the '*' as shown below:

[assembly: AssemblyVersion("1.0.*")]]]></ProjectItem>
              <ProjectItem
                Name="Properties\Resources.resx"
                Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>]]></ProjectItem>
              <ProjectItem
                Name="ScriptMain.cs"
                Encoding="UTF8"><![CDATA[#region Help:  Introduction to the script task
/* The Script Task allows you to perform virtually any operation that can be accomplished in
 * a .Net application within the context of an Integration Services control flow. 
 * 
 * Expand the other regions which have "Help" prefixes for examples of specific ways to use
 * Integration Services features within this script task. */
#endregion


#region Namespaces
using System;
using System.IO;
using System.Data;
using Microsoft.SqlServer.Dts.Runtime;
using System.Windows.Forms;
#endregion

namespace ST_28156e54ce1e4d0990e0426174693417
{
    /// <summary>
    /// ScriptMain is the entry point class of the script.  Do not change the name, attributes,
    /// or parent of this class.
    /// </summary>
	[Microsoft.SqlServer.Dts.Tasks.ScriptTask.SSISScriptTaskEntryPointAttribute]
	public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
	{
        #region Help:  Using Integration Services variables and parameters in a script
        /* To use a variable in this script, first ensure that the variable has been added to 
         * either the list contained in the ReadOnlyVariables property or the list contained in 
         * the ReadWriteVariables property of this script task, according to whether or not your
         * code needs to write to the variable.  To add the variable, save this script, close this instance of
         * Visual Studio, and update the ReadOnlyVariables and 
         * ReadWriteVariables properties in the Script Transformation Editor window.
         * To use a parameter in this script, follow the same steps. Parameters are always read-only.
         * 
         * Example of reading from a variable:
         *  DateTime startTime = (DateTime) Dts.Variables["System::StartTime"].Value;
         * 
         * Example of writing to a variable:
         *  Dts.Variables["User::myStringVariable"].Value = "new value";
         * 
         * Example of reading from a package parameter:
         *  int batchId = (int) Dts.Variables["$Package::batchId"].Value;
         *  
         * Example of reading from a project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].Value;
         * 
         * Example of reading from a sensitive project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].GetSensitiveValue();
         * */

        #endregion

        #region Help:  Firing Integration Services events from a script
        /* This script task can fire events for logging purposes.
         * 
         * Example of firing an error event:
         *  Dts.Events.FireError(18, "Process Values", "Bad value", "", 0);
         * 
         * Example of firing an information event:
         *  Dts.Events.FireInformation(3, "Process Values", "Processing has started", "", 0, ref fireAgain)
         * 
         * Example of firing a warning event:
         *  Dts.Events.FireWarning(14, "Process Values", "No values received for input", "", 0);
         * */
        #endregion

        #region Help:  Using Integration Services connection managers in a script
        /* Some types of connection managers can be used in this script task.  See the topic 
         * "Working with Connection Managers Programatically" for details.
         * 
         * Example of using an ADO.Net connection manager:
         *  object rawConnection = Dts.Connections["Sales DB"].AcquireConnection(Dts.Transaction);
         *  SqlConnection myADONETConnection = (SqlConnection)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Sales DB"].ReleaseConnection(rawConnection);
         *
         * Example of using a File connection manager
         *  object rawConnection = Dts.Connections["Prices.zip"].AcquireConnection(Dts.Transaction);
         *  string filePath = (string)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Prices.zip"].ReleaseConnection(rawConnection);
         * */
        #endregion


		/// <summary>
        /// This method is called when this script task executes in the control flow.
        /// Before returning from this method, set the value of Dts.TaskResult to indicate success or failure.
        /// To open Help, press F1.
        /// </summary>
		public void Main()
		{
            string sImportDir = Dts.Variables["User::ImportDirectory"].Value.ToString();
            string sArchiveDir = Dts.Variables["User::ArchiveDirectory"].Value.ToString();
            string sProcessDir = Dts.Variables["User::ProcessDirectory"].Value.ToString();

            string sMoveLog = Dts.Variables["User::MoveFileLog"].Value.ToString();

            string sRegion = Dts.Variables["User::Region"].Value.ToString();

            //validate that the archive directory exists
            if (PathExists(sArchiveDir) != 0)
            {
                Dts.Variables["User::MoveFileLog"].Value = "Error: Archive Directory does not exist and could not be created: "
                                                            + sArchiveDir;
                Dts.TaskResult = (int)ScriptResults.Success;  //must check MoveFileLog variable in DTS
                return;
            }

            //validate that the processing directory exists
            if (PathExists(sProcessDir) != 0)
            {
                Dts.Variables["User::MoveFileLog"].Value = "Error: Processing Directory does not exist and could not be created: "
                                                            + sProcessDir;
                Dts.TaskResult = (int)ScriptResults.Success; //must check MoveFileLog variable in DTS
                return;
            }

            //get dispatched files for division
            string sFileSearch = "*" + sRegion + "*.OD0";
            string[] saDispatchFiles = Directory.GetFiles(sImportDir, sFileSearch);

            //for (int i = 0; i < saDispatchFiles.Length; i++)
            //{
            //    MessageBox.Show("Found File: " + saDispatchFiles[i]);
            //}

            //get the order dates passed in
            string sOrderDate = Dts.Variables["User::OrderDate"].Value.ToString();
            sOrderDate = sOrderDate.ToString().Replace("-", "");  //remove dashes in order date passed in

            //            MessageBox.Show("Order Date: " + sOrderDate);

            //max index for valid file array
            int iCount = 0;

            //setup array for files to be sorted
            string[] saValidFiles = new string[saDispatchFiles.Length];
            string sFilename;

            //find all files not processed up to the order date passed in
            // skip days in the future as they are intermidiate wave files
            for (int i = 0; i < saDispatchFiles.Length; i++)
            {
                //file date must be less than or equal to order date
                ulong iDispatch = Convert.ToUInt64(saDispatchFiles[i].Substring(sImportDir.Length, 8));
                ulong iOrderDate = Convert.ToUInt64(sOrderDate);
                //                MessageBox.Show("Dispatch " + iDispatch.ToString() + " <= " + iOrderDate.ToString() + " Order");
                if (iDispatch <= iOrderDate)
                {
                    saValidFiles[iCount] = saDispatchFiles[i];  //save only files that are to be imported
                    iCount++;
                }
                else  //move file to archive and label as skipped
                {
                    //move file to Archive directory
                    sFilename = saDispatchFiles[i].Substring(saDispatchFiles[i].LastIndexOf("\\") + 1);
                    File.Copy(saDispatchFiles[i], sArchiveDir + sFilename + "-Skipped", true);
                    File.Delete(saDispatchFiles[i]);
                }
            }

            //sort array values by date as there can be multiple dispatched dates
            Array.Sort(saValidFiles); //desc order
            Array.Reverse(saValidFiles); //reverse order

            //MessageBox.Show("Good file count: " + iCount.ToString());

            //for (int i = 0; i < iCount; i++)
            //{
            //    MessageBox.Show(saValidFiles[i]);
            //}


            //initialize file date
            string sFiledate = "";

            //separate by order date
            for (int i = 0; i < iCount; i++)
            {
                sFilename = saValidFiles[i].Substring(saDispatchFiles[i].LastIndexOf("\\") + 1);

                //compare dates and if new date then move to process
                //assume that the reverse sort puts the correct file at
                //the first file with a new date
                //                MessageBox.Show(sFiledate + " != " + saValidFiles[i].Substring(sImportDir.Length, 8));
                if (sFiledate != saValidFiles[i].Substring(sImportDir.Length, 8))
                {
                    //move file to process directory
                    //                    MessageBox.Show("Processing: " + sFilename);
                    File.Copy(saValidFiles[i], sProcessDir + sFilename, true);
                    File.Delete(saValidFiles[i]);
                    sFiledate = saValidFiles[i].Substring(sImportDir.Length, 8);
                }
                else
                {
                    //move file to Archive directory
                    //                    MessageBox.Show("Skipping: " + sFilename);
                    File.Copy(saValidFiles[i], sArchiveDir + sFilename + "-Skipped", true);
                    File.Delete(saValidFiles[i]);
                }
            }

            Dts.TaskResult = (int)ScriptResults.Success;
            return;
        }

        public static int PathExists(string path)
        {
            try
            {
                if (!Directory.Exists(path))
                {
                    Directory.CreateDirectory(path);
                    //                    MessageBox.Show("Created new directory: " + path);
                }
                //                MessageBox.Show("Directory Exists: " + path);

            }
            catch
            {
                //                MessageBox.Show("Error: path not found or created: " + path);
                return 1;
            }
            return 0;
        }

        #region ScriptResults declaration
        /// <summary>
        /// This enum provides a convenient shorthand within the scope of this class for setting the
        /// result of the script.
        /// 
        /// This code was generated automatically.
        /// </summary>
        enum ScriptResults
        {
            Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
            Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
        };
        #endregion

	}
}]]></ProjectItem>
              <ProjectItem
                Name="Project"
                Encoding="UTF16LE"><![CDATA[<?xml version="1.0" encoding="UTF-16" standalone="yes"?>
<c:Project xmlns:c="http://schemas.microsoft.com/codeprojectml/2010/08/main" xmlns:msb="http://schemas.microsoft.com/developer/msbuild/2003" runtimeVersion="4.0" schemaVersion="1.0">
  <msb:PropertyGroup>
    <msb:CodeName>ST_28156e54ce1e4d0990e0426174693417</msb:CodeName>
    <msb:Language>msBuild</msb:Language>
    <msb:DisplayName>ST_28156e54ce1e4d0990e0426174693417</msb:DisplayName>
    <msb:ProjectId>{0821DB0B-271D-45B5-8C9D-97D407B5BDEB}</msb:ProjectId>
  </msb:PropertyGroup>
  <msb:ItemGroup>
    <msb:Project Include="ST_28156e54ce1e4d0990e0426174693417.csproj" />
    <msb:File Include="Properties\Resources.Designer.cs" />
    <msb:File Include="Properties\Settings.settings" />
    <msb:File Include="Properties\AssemblyInfo.cs" />
    <msb:File Include="Properties\Resources.resx" />
    <msb:File Include="Properties\Settings.Designer.cs" />
    <msb:File Include="ScriptMain.cs" />
  </msb:ItemGroup>
</c:Project>]]></ProjectItem>
              <ProjectItem
                Name="Properties\Settings.Designer.cs"
                Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_28156e54ce1e4d0990e0426174693417.Properties.Settings.get_Default():ST_28156e54ce1e4d0990e0426174693417.Properties.Sett" +
    "ings")]

namespace ST_28156e54ce1e4d0990e0426174693417.Properties {
    
    
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        private static Settings defaultInstance = new Settings();
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}]]></ProjectItem>
              <ProjectItem
                Name="ST_28156e54ce1e4d0990e0426174693417.csproj"
                Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProjectTypeGuids>{30D016F9-3734-4E33-A861-5E7D899E18F3};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{60b4ac8c-3d75-45aa-b06d-448f20aa9dfa}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>ST_28156e54ce1e4d0990e0426174693417</RootNamespace>
    <AssemblyName>ST_28156e54ce1e4d0990e0426174693417</AssemblyName>
    <TargetFrameworkVersion>v4.7</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>true</ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>
    <TargetFrameworkProfile></TargetFrameworkProfile>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>.\bin\Debug\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <DebugSymbols>false</DebugSymbols>
    <Optimize>true</Optimize>
    <OutputPath>.\bin\Release\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.SqlServer.ManagedDTS, Version=15.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="Microsoft.SqlServer.ScriptTask, Version=15.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
  </ItemGroup>
  <ItemGroup>
    <AppDesigner Include="Properties\" />
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
    </Compile>
    <Compile Include="ScriptMain.cs">
      <SubType>Code</SubType>
    </Compile>
  </ItemGroup>
  <!-- Include the build rules for a C# project.-->
  <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />
  <ProjectExtensions>
    <VisualStudio>
      <FlavorProperties GUID="{30D016F9-3734-4E33-A861-5E7D899E18F3}">
        <ProjectProperties HostName="ScriptTask" HostPackage="{B3A685AA-7EAF-4BC6-9940-57959FA5AC07}" ApplicationType="usd" Language="cs" TemplatesPath="" DebugInfoCommandLine="" DebugInfoWorkingDir="" IconImageList="" />
        <Host Name="ScriptTask" GeneratedNamespace="$safeprojectname" IconIndex=""></Host>
        <ProjectClient>
          <HostIdentifier>SSIS_ST150</HostIdentifier>
        </ProjectClient>
      </FlavorProperties>
    </VisualStudio>
  </ProjectExtensions>
</Project>]]></ProjectItem>
              <ProjectItem
                Name="Properties\Settings.settings"
                Encoding="UTF8"><![CDATA[<?xml version='1.0' encoding='iso-8859-1'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>]]></ProjectItem>
              <ProjectItem
                Name="Properties\Resources.Designer.cs"
                Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_28156e54ce1e4d0990e0426174693417.Properties.Resources.get_ResourceManager():System.Resources.Resou" +
    "rceManager")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_28156e54ce1e4d0990e0426174693417.Properties.Resources.get_Culture():System.Globalization.CultureIn" +
    "fo")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_28156e54ce1e4d0990e0426174693417.Properties.Resources.set_Culture(System.Globalization.CultureInfo" +
    "):Void")]

namespace ST_28156e54ce1e4d0990e0426174693417.Properties {
    
    
    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if ((resourceMan == null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("ST_28156e54ce1e4d0990e0426174693417.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}]]></ProjectItem>
              <BinaryItem
                Name="ST_28156e54ce1e4d0990e0426174693417.dll">TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1v
ZGUuDQ0KJAAAAAAAAABQRQAATAEDAMdwwWQAAAAAAAAAAOAAIiALATAAABYAAAAIAAAAAAAATjQA
AAAgAAAAQAAAAAAAEAAgAAAAAgAABAAAAAAAAAAGAAAAAAAAAACAAAAAAgAAAAAAAAMAYIUAABAA
ABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAPwzAABPAAAAAEAAAHgEAAAAAAAAAAAAAAAAAAAA
AAAAAGAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAIAAACAAAAAAAAAAAAAAACCAAAEgAAAAAAAAAAAAAAC50ZXh0AAAAVBQAAAAgAAAAFgAAAAIA
AAAAAAAAAAAAAAAAACAAAGAucnNyYwAAAHgEAAAAQAAAAAYAAAAYAAAAAAAAAAAAAAAAAABAAABA
LnJlbG9jAAAMAAAAAGAAAAACAAAAHgAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAAAw
NAAAAAAAAEgAAAACAAUAxCMAAIAPAAABAAAAAAAAAEQzAAC4AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAABMwBADFAgAAAQAAEQIoEAAACm8RAAAKcgEAAHBvEgAACm8T
AAAKbxQAAAoKAigQAAAKbxEAAApyLQAAcG8SAAAKbxMAAApvFAAACgsCKBAAAApvEQAACnJbAABw
bxIAAApvEwAACm8UAAAKDAIoEAAACm8RAAAKcokAAHBvEgAACm8TAAAKbxQAAAomAigQAAAKbxEA
AApyrQAAcG8SAAAKbxMAAApvFAAACg0HKAIAAAYsMgIoEAAACm8RAAAKcokAAHBvEgAACnLHAABw
BygVAAAKbxYAAAoCKBAAAAoWbxcAAAoqCCgCAAAGLDICKBAAAApvEQAACnKJAABwbxIAAApyTgEA
cAgoFQAACm8WAAAKAigQAAAKFm8XAAAKKnLbAQBwCXLfAQBwKBgAAAoTBAYRBCgZAAAKEwUCKBAA
AApvEQAACnLrAQBwbxIAAApvEwAACm8UAAAKEwYRBm8UAAAKcgsCAHByDwIAcG8aAAAKEwYWEwcR
BY5pjRsAAAETCBYTCyt6EQURC5oGbxsAAAoebxwAAAooHQAAChEGKB0AAAoTDBEMNRIRCBEHEQUR
C5qiEQcXWBMHKz8RBRELmhEFEQuachECAHBvHgAAChdYbx8AAAoTCREFEQuaBxEJchUCAHAoGAAA
ChcoIAAAChEFEQuaKCEAAAoRCxdYEwsRCxEFjmk/e////xEIKAEAACsRCCgjAAAKcg8CAHATChYT
DTiRAAAAEQgRDZoRBRENmnIRAgBwbx4AAAoXWG8fAAAKEwkRChEIEQ2aBm8bAAAKHm8cAAAKKCQA
AAosMhEIEQ2aCBEJKBUAAAoXKCAAAAoRCBENmighAAAKEQgRDZoGbxsAAAoebxwAAAoTCisiEQgR
DZoHEQlyFQIAcCgYAAAKFyggAAAKEQgRDZooIQAAChENF1gTDRENEQc/Zv///wIoEAAAChZvFwAA
CioAAAAbMAEAGgAAAAIAABECKCUAAAotBwIoJgAACibeBSYXCt4CFioGKgAAARAAAAAAAAAREQAF
DwAAAR4CKCcAAAoqHgIoKAAACiqufgEAAAQtHnInAgBw0AMAAAIoKQAACm8qAAAKcysAAAqAAQAA
BH4BAAAEKhp+AgAABCoeAoACAAAEKhp+AwAABCoeAigsAAAKKi5zCQAABoADAAAEKgAAQlNKQgEA
AQAAAAAADAAAAHY0LjAuMzAzMTkAAAAABQBsAAAAZAQAACN+AADQBAAAHAYAACNTdHJpbmdzAAAA
AOwKAACcAgAAI1VTAIgNAAAQAAAAI0dVSUQAAACYDQAA6AEAACNCbG9iAAAAAAAAAAIAAAFXHaIB
CQsAAAD6ATMAFgAAAQAAACMAAAAFAAAABgAAAAoAAAACAAAALAAAAAIAAAAQAAAAAgAAAAIAAAAD
AAAABAAAAAEAAAAEAAAAAQAAAAEAAAABAAAAAADUAwEAAAAAAAYAVAKyBAYA4wKyBAYAoAGfBA8A
JgUAAAYAzQFSBAYANwJSBAYAGAJSBAYAygJSBAYAdAJSBAYAjQJSBAYA5AFSBAYA/wEnAwoAqAKD
AwoAEAGDAwYAtAUFBAYADAQFBAYAgwGfBAYAggTSBAYAZAQ9BA4ATAG+Aw4AtAG+Aw4ALAEoBAYA
aAGyBAoArAODAxIAaAW7ABIAiQC7AAYAQwMFBAYAAQY3AAYA1gUFBAYAtgA3AAYA4wUFBAYAcAQ3
AAYA2wAFBAYAkgAFBAYA7QVSBAAAAAAuAAAAAAABAAEAAQAQAB0ECgA5AAEAAQAAABAA2QQ1BT0A
AQAEAAABEAB7BTUFWQADAAgAAwEAAJQFAABBAAQACwARABEE5QARAAAB6QARAHkA7QAGBmAA8QBW
gIQF9ABWgOAA9ABQIAAAAACGACMEBgABACQjAAAAAJYAogX4AAEAXCMAAAAAhhiSBAYAAgBkIwAA
AACDGJIEBgACAGwjAAAAAJMIfgT9AAIAmCMAAAAAkwjoAAIBAgCfIwAAAACTCPQABwECAKcjAAAA
AJYIuwUNAQMAriMAAAAAhhiSBAYAAwC2IwAAAACRGJgEEgEDAAAAAQBUAwAAAQAVAwkAkgQBABEA
kgQGABkAkgQKACkAkgQQADEAkgQQADkAkgQQAEEAkgQQAEkAkgQQAFEAkgQQAFkAkgQQAGEAkgQQ
AGkAkgQGAIkAkgQGAKkAkgQVALkAkgQGAHEAjAUuAMEAZAUzAMkA/AM4ANEAAQM+AHkAQQNCANkA
rQVGANEACwNMAMEAxwUBANkArQVRAOEAcgVYANkAcQBfANkAWQNlANkASgNpAOkAAQBvANkAGwN0
ANkASgN5APEA9gV+APEAYQGFAPkA3gWKAPkARAGWANkACwacAOEApgWmAOEA+wWrAHEAkgQGAHkA
kgQGAAkBpACyAAkB6QW7AJEAkgTBALEAkgQGAAgAFADbAAgAGADgACkAcwBNAS4ACwAlAS4AEwAu
AS4AGwBNAS4AIwBWAS4AKwB/AS4AMwB/AS4AOwB/AS4AQwBWAS4ASwCFAS4AUwB/AS4AWwCcAUMA
YwDgAEkAcwBNAWEAewDgAGMAawDgABsAogADAAEABAADAAAAggQWAQAACAEbAQAAvwUgAQIABQAD
AAIABgAFAAEABwAFAAIACAAHAASAAAABAAAAnyErVgAAAAAAAAoAAAAEAAAAAAAAAAAAAADJAGgA
AAAAAA8AAAAAAAAAAAAAANIAZAMAAAAABAAAAAAAAAAAAAAAyQAFBAAAAAAPAAAAAAAAAAAAAADS
AEEAAAAAAAAAAAABAAAA4wQAAAUAAgBFAJIAAAAAVG9VSW50NjQAU1RfMjgxNTZlNTRjZTFlNGQw
OTkwZTA0MjYxNzQ2OTM0MTcAPE1vZHVsZT4AU3lzdGVtLklPAE1pY3Jvc29mdC5TcWxTZXJ2ZXIu
TWFuYWdlZERUUwB2YWx1ZV9fAG1zY29ybGliAFJlcGxhY2UAZGVmYXVsdEluc3RhbmNlAFZhcmlh
YmxlAFJ1bnRpbWVUeXBlSGFuZGxlAEdldFR5cGVGcm9tSGFuZGxlAEZpbGUATWljcm9zb2Z0LlNx
bFNlcnZlci5EdHMuUnVudGltZQBUeXBlAEZhaWx1cmUAZ2V0X0N1bHR1cmUAc2V0X0N1bHR1cmUA
cmVzb3VyY2VDdWx0dXJlAFZTVEFSVFNjcmlwdE9iamVjdE1vZGVsQmFzZQBBcHBsaWNhdGlvblNl
dHRpbmdzQmFzZQBSZXZlcnNlAEVkaXRvckJyb3dzYWJsZVN0YXRlAERlbGV0ZQBDb21waWxlckdl
bmVyYXRlZEF0dHJpYnV0ZQBEZWJ1Z2dlck5vblVzZXJDb2RlQXR0cmlidXRlAERlYnVnZ2FibGVB
dHRyaWJ1dGUARWRpdG9yQnJvd3NhYmxlQXR0cmlidXRlAEFzc2VtYmx5VGl0bGVBdHRyaWJ1dGUA
QXNzZW1ibHlUcmFkZW1hcmtBdHRyaWJ1dGUAVGFyZ2V0RnJhbWV3b3JrQXR0cmlidXRlAEFzc2Vt
Ymx5Q29uZmlndXJhdGlvbkF0dHJpYnV0ZQBBc3NlbWJseURlc2NyaXB0aW9uQXR0cmlidXRlAENv
bXBpbGF0aW9uUmVsYXhhdGlvbnNBdHRyaWJ1dGUAQXNzZW1ibHlQcm9kdWN0QXR0cmlidXRlAEFz
c2VtYmx5Q29weXJpZ2h0QXR0cmlidXRlAFNTSVNTY3JpcHRUYXNrRW50cnlQb2ludEF0dHJpYnV0
ZQBBc3NlbWJseUNvbXBhbnlBdHRyaWJ1dGUAUnVudGltZUNvbXBhdGliaWxpdHlBdHRyaWJ1dGUA
Z2V0X1ZhbHVlAHNldF9WYWx1ZQB2YWx1ZQBMYXN0SW5kZXhPZgBTeXN0ZW0uUnVudGltZS5WZXJz
aW9uaW5nAFRvU3RyaW5nAFN1YnN0cmluZwBwYXRoAGdldF9MZW5ndGgATWljcm9zb2Z0LlNxbFNl
cnZlci5TY3JpcHRUYXNrAE1pY3Jvc29mdC5TcWxTZXJ2ZXIuRHRzLlRhc2tzLlNjcmlwdFRhc2sA
U2NyaXB0T2JqZWN0TW9kZWwAU3lzdGVtLkNvbXBvbmVudE1vZGVsAFNUXzI4MTU2ZTU0Y2UxZTRk
MDk5MGUwNDI2MTc0NjkzNDE3LmRsbABnZXRfSXRlbQBTeXN0ZW0ARW51bQByZXNvdXJjZU1hbgBT
Y3JpcHRNYWluAFN5c3RlbS5Db25maWd1cmF0aW9uAFN5c3RlbS5HbG9iYWxpemF0aW9uAFN5c3Rl
bS5SZWZsZWN0aW9uAEN1bHR1cmVJbmZvAERpcmVjdG9yeUluZm8AZ2V0X1Jlc291cmNlTWFuYWdl
cgAuY3RvcgAuY2N0b3IAU3lzdGVtLkRpYWdub3N0aWNzAFN5c3RlbS5SdW50aW1lLkNvbXBpbGVy
U2VydmljZXMAU3lzdGVtLlJlc291cmNlcwBTVF8yODE1NmU1NGNlMWU0ZDA5OTBlMDQyNjE3NDY5
MzQxNy5Qcm9wZXJ0aWVzLlJlc291cmNlcy5yZXNvdXJjZXMARGVidWdnaW5nTW9kZXMAU1RfMjgx
NTZlNTRjZTFlNGQwOTkwZTA0MjYxNzQ2OTM0MTcuUHJvcGVydGllcwBnZXRfVmFyaWFibGVzAEdl
dEZpbGVzAFNldHRpbmdzAFN1Y2Nlc3MAZ2V0X0R0cwBTY3JpcHRSZXN1bHRzAFBhdGhFeGlzdHMA
Q29uY2F0AE9iamVjdABnZXRfRGVmYXVsdABzZXRfVGFza1Jlc3VsdABDb252ZXJ0AFNvcnQAQXJy
YXkAZ2V0X0Fzc2VtYmx5AENvcHkAQ3JlYXRlRGlyZWN0b3J5AG9wX0luZXF1YWxpdHkAAAAAACtV
AHMAZQByADoAOgBJAG0AcABvAHIAdABEAGkAcgBlAGMAdABvAHIAeQAALVUAcwBlAHIAOgA6AEEA
cgBjAGgAaQB2AGUARABpAHIAZQBjAHQAbwByAHkAAC1VAHMAZQByADoAOgBQAHIAbwBjAGUAcwBz
AEQAaQByAGUAYwB0AG8AcgB5AAAjVQBzAGUAcgA6ADoATQBvAHYAZQBGAGkAbABlAEwAbwBnAAAZ
VQBzAGUAcgA6ADoAUgBlAGcAaQBvAG4AAICFRQByAHIAbwByADoAIABBAHIAYwBoAGkAdgBlACAA
RABpAHIAZQBjAHQAbwByAHkAIABkAG8AZQBzACAAbgBvAHQAIABlAHgAaQBzAHQAIABhAG4AZAAg
AGMAbwB1AGwAZAAgAG4AbwB0ACAAYgBlACAAYwByAGUAYQB0AGUAZAA6ACAAAICLRQByAHIAbwBy
ADoAIABQAHIAbwBjAGUAcwBzAGkAbgBnACAARABpAHIAZQBjAHQAbwByAHkAIABkAG8AZQBzACAA
bgBvAHQAIABlAHgAaQBzAHQAIABhAG4AZAAgAGMAbwB1AGwAZAAgAG4AbwB0ACAAYgBlACAAYwBy
AGUAYQB0AGUAZAA6ACAAAAMqAAALKgAuAE8ARAAwAAAfVQBzAGUAcgA6ADoATwByAGQAZQByAEQA
YQB0AGUAAAMtAAEBAANcAAARLQBTAGsAaQBwAHAAZQBkAAFxUwBUAF8AMgA4ADEANQA2AGUANQA0
AGMAZQAxAGUANABkADAAOQA5ADAAZQAwADQAMgA2ADEANwA0ADYAOQAzADQAMQA3AC4AUAByAG8A
cABlAHIAdABpAGUAcwAuAFIAZQBzAG8AdQByAGMAZQBzAAAAAADG/kgdr37OTqsqAapb1BGtAAQg
AQEIAyAAAQUgAQEREQQgAQEOBSABARFREgcODg4ODg4dDg4IHQ4ODggLCAQgABJhBCAAEmUFIAES
aRwDIAAcAyAADgUAAg4ODgQgAQEcBgADDg4ODgYAAh0ODg4FIAIODg4DIAAIBSACDggIBAABCw4E
IAEIDgQgAQ4IBgADAQ4OAgQAAQEOBxABAQEdHgADCgEOBQABARJ9BQACAg4OAwcBCAQAAQIOBgAB
EoCBDggAARKAhRGAiQUgABKAjQcgAgEOEoCNCLd6XFYZNOCJCImEXc2AgMyRBAAAAAAEAQAAAAMG
EkkDBhJNAwYSEAIGCAMGERQEAAEIDgQAABJJBAAAEk0FAAEBEk0EAAASEAMAAAEECAASSQQIABJN
BAgAEhAIAQAIAAAAAAAeAQABAFQCFldyYXBOb25FeGNlcHRpb25UaHJvd3MBCAEAAgAAAAAAKAEA
I1NUXzI4MTU2ZTU0Y2UxZTRkMDk5MGUwNDI2MTc0NjkzNDE3AAAFAQAAAAAWAQARQ29weXJpZ2h0
IEAgIDIwMjMAAEkBABouTkVURnJhbWV3b3JrLFZlcnNpb249djQuNwEAVA4URnJhbWV3b3JrRGlz
cGxheU5hbWUSLk5FVCBGcmFtZXdvcmsgNC43AAC0AAAAzsrvvgEAAACRAAAAbFN5c3RlbS5SZXNv
dXJjZXMuUmVzb3VyY2VSZWFkZXIsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9
bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OSNTeXN0ZW0uUmVzb3VyY2Vz
LlJ1bnRpbWVSZXNvdXJjZVNldAIAAAAAAAAAAAAAAFBBRFBBRFC0AAAAJDQAAAAAAAAAAAAAPjQA
AAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAADA0AAAAAAAAAAAAAAAAX0NvckRsbE1haW4AbXNjb3Jl
ZS5kbGwAAAAAAP8lACAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAABABAAAAAYAACAAAAAAAAAAAAAAAAAAAABAAEAAAAwAACAAAAAAAAAAAAAAAAAAAABAAAAAABI
AAAAWEAAABoEAAAAAAAAAAAAABoENAAAAFYAUwBfAFYARQBSAFMASQBPAE4AXwBJAE4ARgBPAAAA
AAC9BO/+AAABAAAAAQArVp8hAAABACtWnyE/AAAAAAAAAAQAAAACAAAAAAAAAAAAAAAAAAAARAAA
AAEAVgBhAHIARgBpAGwAZQBJAG4AZgBvAAAAAAAkAAQAAABUAHIAYQBuAHMAbABhAHQAaQBvAG4A
AAAAAAAAsAR6AwAAAQBTAHQAcgBpAG4AZwBGAGkAbABlAEkAbgBmAG8AAABWAwAAAQAwADAAMAAw
ADAANABiADAAAAAaAAEAAQBDAG8AbQBtAGUAbgB0AHMAAAAAAAAAIgABAAEAQwBvAG0AcABhAG4A
eQBOAGEAbQBlAAAAAAAAAAAAcAAkAAEARgBpAGwAZQBEAGUAcwBjAHIAaQBwAHQAaQBvAG4AAAAA
AFMAVABfADIAOAAxADUANgBlADUANABjAGUAMQBlADQAZAAwADkAOQAwAGUAMAA0ADIANgAxADcA
NAA2ADkAMwA0ADEANwAAAD4ADwABAEYAaQBsAGUAVgBlAHIAcwBpAG8AbgAAAAAAMQAuADAALgA4
ADYAMAA3AC4AMgAyADAANQA5AAAAAABwACgAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAFMA
VABfADIAOAAxADUANgBlADUANABjAGUAMQBlADQAZAAwADkAOQAwAGUAMAA0ADIANgAxADcANAA2
ADkAMwA0ADEANwAuAGQAbABsAAAASAASAAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0AAAA
QwBvAHAAeQByAGkAZwBoAHQAIABAACAAIAAyADAAMgAzAAAAKgABAAEATABlAGcAYQBsAFQAcgBh
AGQAZQBtAGEAcgBrAHMAAAAAAAAAAAB4ACgAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBuAGEA
bQBlAAAAUwBUAF8AMgA4ADEANQA2AGUANQA0AGMAZQAxAGUANABkADAAOQA5ADAAZQAwADQAMgA2
ADEANwA0ADYAOQAzADQAMQA3AC4AZABsAGwAAABoACQAAQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUA
AAAAAFMAVABfADIAOAAxADUANgBlADUANABjAGUAMQBlADQAZAAwADkAOQAwAGUAMAA0ADIANgAx
ADcANAA2ADkAMwA0ADEANwAAAEIADwABAFAAcgBvAGQAdQBjAHQAVgBlAHIAcwBpAG8AbgAAADEA
LgAwAC4AOAA2ADAANwAuADIAMgAwADUAOQAAAAAARgAPAAEAQQBzAHMAZQBtAGIAbAB5ACAAVgBl
AHIAcwBpAG8AbgAAADEALgAwAC4AOAA2ADAANwAuADIAMgAwADUAOQAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAwAAABQNAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=</BinaryItem>
            </ScriptProject>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:ForEachVariableMappings>
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{D616DC89-DBB3-4D70-919D-A7CBA50864EB}"
          DTS:ObjectName="{D616DC89-DBB3-4D70-919D-A7CBA50864EB}"
          DTS:ValueIndex="0"
          DTS:VariableName="User::Region" />
      </DTS:ForEachVariableMappings>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Foreach File Check that it isnt already Imported"
      DTS:CreationName="STOCK:FOREACHLOOP"
      DTS:Description="Foreach Loop Container"
      DTS:DTSID="{068FEB9F-733B-40B8-A0F9-90E0A8CABA5B}"
      DTS:ExecutableType="STOCK:FOREACHLOOP"
      DTS:LocaleID="-1"
      DTS:ObjectName="Foreach File Check that it isnt already Imported">
      <DTS:ForEachEnumerator
        DTS:CreationName="Microsoft.ForEachFileEnumerator"
        DTS:DTSID="{6C7685C3-B08F-4D07-BD14-3D7070A77807}"
        DTS:ObjectName="{6C7685C3-B08F-4D07-BD14-3D7070A77807}">
        <DTS:PropertyExpression
          DTS:Name="Directory">@[User::ProcessDirectory]</DTS:PropertyExpression>
        <DTS:ObjectData>
          <ForEachFileEnumeratorProperties>
            <FEFEProperty
              Folder="\\srvrmanage224\Transfers\PutToLight-PCDATA_TEST\Inbound\Processing\" />
            <FEFEProperty
              FileSpec="*.OD0" />
            <FEFEProperty
              FileNameRetrievalType="1" />
            <FEFEProperty
              Recurse="0" />
          </ForEachFileEnumeratorProperties>
        </DTS:ObjectData>
      </DTS:ForEachEnumerator>
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Foreach File Check that it isnt already Imported\Check Wave Type"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{E51EFE65-7BDB-4CB5-A608-FAB6366D631F}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Check Wave Type"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{8914C185-EC6E-4AB3-B9F1-DEF1E51955D2}"
              SQLTask:SqlStatementSource="declare @filename as varchar(50) = ?&#xA;declare @region as varchar(10) = ?&#xA;&#xA;--declare @filename as varchar(50) = '20230627_POR-DAVIS.OD0'&#xA;--declare @region as varchar(10) = 'POR-DAVIS'&#xA;&#xA;select case when len(@filename) - len(replace(@filename, '_', '')) = 1 then 1&#xA;&#x9;&#x9;else substring(@filename, 10, 1) end as 'WaveType'&#xA;&#x9;&#x9;,[ShippingEmail]&#xA;&#xA;&#x9;from [dbo].[PC_Data_Administration]&#xA;&#x9;where [RegionalBakery] = @region"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::WaveType" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="1"
                SQLTask:DtsVariableName="User::ShippingEmail" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::DispatchFilename"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::Region"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Foreach File Check that it isnt already Imported\Get File Dispatch Order Date"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{43881574-C258-44F5-B4E7-93213FEC2846}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Get File Dispatch Order Date"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{8914C185-EC6E-4AB3-B9F1-DEF1E51955D2}"
              SQLTask:SqlStatementSource="--Get File Dispatch Date and Regional Bakery&#xA;Declare @DispatchFilename as varchar(100) = ? --'20200222_POR-DAVIS.OD0' -- ?&#xA;&#xA;--Declare @DispatchFilename as varchar(100) = '20200911_POR-DAVIS.OD0' -- '20200911_POR-DAVIS.OD0'&#xA;&#xA;select convert(date, Left(@DispatchFilename,8)) as 'DispatchDate'&#xA;&#x9;  ,REVERSE(SUBSTRING(REVERSE(@DispatchFilename), CHARINDEX('.',REVERSE(@DispatchFilename))+1,&#xA;&#x9;&#x9;&#x9;&#x9;CHARINDEX('_', REVERSE(@DispatchFilename)) -CHARINDEX('.',REVERSE(@DispatchFilename))-1)) as 'Region'&#xA;&#xA;&#xA;"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::DispatchOrderDate" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="1"
                SQLTask:DtsVariableName="User::Region" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::DispatchFilename"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Foreach File Check that it isnt already Imported\Has the Order Date been Dispatched"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{E1633185-8EB1-479C-8ABC-6CE06FE93FFA}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Has the Order Date been Dispatched"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{8914C185-EC6E-4AB3-B9F1-DEF1E51955D2}"
              SQLTask:SqlStatementSource="Declare @DispatchOrderDate as varchar(10) = ? -- '2020-02-27'&#xA;Declare @RegionalBakery as varchar(20) = ?  -- 'POR-DAVIS'&#xA;&#xA;--Declare @DispatchOrderDate as varchar(10) = '2020-09-18'&#xA;--Declare @RegionalBakery as varchar(20) = 'POR-DAVIS'&#xA;&#xA;select Count(*) as 'ImportStatus'&#xA;&#x9;FROM [dbo].[PC_Data_ImportExport_Monitor] as MON with(nolock)&#xA;&#x9;Where CAST(MON.[OrderDate] as date) = @DispatchOrderDate&#xA;&#x9;&#x9;and MON.RegionalBakery = @RegionalBakery&#xA;&#x9;&#x9;and MON.ImportDateTime is NOT NULL&#xA; ;"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::ImportStatus" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::DispatchOrderDate"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::Region"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Foreach File Check that it isnt already Imported\Move Bad File to Archive and Rename"
          DTS:CreationName="Microsoft.FileSystemTask"
          DTS:DelayValidation="True"
          DTS:Description="File System Task"
          DTS:DTSID="{4B40B954-48E4-40E3-B574-B3012A656362}"
          DTS:ExecutableType="Microsoft.FileSystemTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Move Bad File to Archive and Rename"
          DTS:TaskContact="File System Task;Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:ObjectData>
            <FileSystemData
              TaskOperationType="RenameFile"
              TaskOverwriteDestFile="True"
              TaskSourcePath="User::BadFileSource"
              TaskIsSourceVariable="True"
              TaskDestinationPath="User::BadFileDestination"
              TaskIsDestinationVariable="True" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Foreach File Check that it isnt already Imported\Process Valid Dispatch Files"
          DTS:CreationName="Microsoft.ExecutePackageTask"
          DTS:Description="Execute Package Task"
          DTS:DTSID="{42FF5E62-5F73-48D6-8D86-040E7F8E9F81}"
          DTS:ExecutableType="Microsoft.ExecutePackageTask"
          DTS:FailPackageOnFailure="True"
          DTS:FailParentOnFailure="True"
          DTS:LocaleID="-1"
          DTS:ObjectName="Process Valid Dispatch Files"
          DTS:TaskContact="Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:LoggingOptions
            DTS:LoggingMode="1" />
          <DTS:ObjectData>
            <ExecutePackageTask>
              <UseProjectReference>True</UseProjectReference>
              <PackageName>PCData_Route_ProcessValidDispatchFiles_v6.dtsx</PackageName>
              <ParameterAssignment>
                <ParameterName>ProcessDirectory</ParameterName>
                <BindedVariableOrParameterName>User::ProcessDirectory</BindedVariableOrParameterName>
              </ParameterAssignment>
              <ParameterAssignment>
                <ParameterName>ArchiveDirectory</ParameterName>
                <BindedVariableOrParameterName>User::ArchiveDirectory</BindedVariableOrParameterName>
              </ParameterAssignment>
              <ParameterAssignment>
                <ParameterName>DebugMode</ParameterName>
                <BindedVariableOrParameterName>User::DebugMode</BindedVariableOrParameterName>
              </ParameterAssignment>
              <ParameterAssignment>
                <ParameterName>DispatchFileName</ParameterName>
                <BindedVariableOrParameterName>User::DispatchFilename</BindedVariableOrParameterName>
              </ParameterAssignment>
            </ExecutePackageTask>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Foreach File Check that it isnt already Imported\Send Mail Task"
          DTS:CreationName="Microsoft.SendMailTask"
          DTS:Description="Send Mail Task"
          DTS:DTSID="{25700743-03F6-4691-8F7D-2D5953611BFF}"
          DTS:ExecutableType="Microsoft.SendMailTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Send Mail Task"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; SQL Server 2019; © 2019 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[User::ErrorEmailFrom]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[User::ShippingEmail]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{710979CD-AC2F-4F05-9D13-F7EE02B86A87}"
              SendMailTask:From="SSIS_Svc@usbakery.com"
              SendMailTask:CC="max.schneider@usbakery.com"
              SendMailTask:Subject="WARNING PCData Incorrect wave file received"
              SendMailTask:MessageSourceType="Variable"
              SendMailTask:MessageSource="User::EmailSendErrorMsg" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Foreach File Check that it isnt already Imported\Send Warning Email of Bad file"
          DTS:CreationName="Microsoft.SendMailTask"
          DTS:DelayValidation="True"
          DTS:Description="Send Mail Task"
          DTS:Disabled="True"
          DTS:DTSID="{590CDFBB-35F5-4978-A73A-EFED27DAAE9B}"
          DTS:ExecutableType="Microsoft.SendMailTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Send Warning Email of Bad file"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="CCLine">@[User::EmailWarningTo]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FileAttachments">@[User::BadFileDestination]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[User::ErrorEmailFrom]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="MessageSource">"Warning: The file listed below has already been Imported or has an Order Date that does not exist in the Shipping Calendar.

" +  @[User::ArchiveDirectory] +  @[User::DispatchFilename] + ( @[User::ImportStatus] == 1 ? "-PreviouslyImported" : "-InvalidOrdDate")+  "

&lt;" +  @[System::MachineName] + ", Old_Handheld_Exports - ALL Divisions PROD, " +  @[System::PackageName] + "&gt;"</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">"Warning - Business Systems - PC_Data - Dispatch File Skipped"</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">"franz.support@usbakery.com"</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{710979CD-AC2F-4F05-9D13-F7EE02B86A87}"
              SendMailTask:From="SSIS_Svc@usbakery.com"
              SendMailTask:To="franz.support@usbakery.com"
              SendMailTask:CC="paul.cardon@usbakery.com;max.schneider@usbakery.com"
              SendMailTask:Subject="Warning - Business Systems - PC_Data - Dispatch File Skipped"
              SendMailTask:MessageSource="Warning: The file listed below has already been Imported or has an Order Date that does not exist in the Shipping Calendar.&#xA;&#xA;\\srvrmanage224\Transfers\PutToLight-PCDATA_TEST\Inbound\Archive\20240130_1_1_BIL-MIDLND.OD0-InvalidOrdDate&#xA;&#xA;&lt;LAP31893, Old_Handheld_Exports - ALL Divisions PROD, PCData_Route_GetDispatchedOrders_v6&gt;" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask">
              <SendMailTask:Attachments
                SendMailTask:FileName="\\srvrmanage224\Transfers\PutToLight-PCDATA_TEST\Inbound\Archive\20240130_1_1_BIL-MIDLND.OD0-Skipped" />
            </SendMailTask:SendMailTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{724D16E4-CC40-4A93-8872-1E8F7E235765}"
          DTS:From="Package\Foreach File Check that it isnt already Imported\Get File Dispatch Order Date"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\Foreach File Check that it isnt already Imported\Has the Order Date been Dispatched" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{0FB6C0DD-B9BE-4562-A501-6F9EADEA0CDB}"
          DTS:EvalOp="3"
          DTS:Expression="@[User::ImportStatus] != 0"
          DTS:From="Package\Foreach File Check that it isnt already Imported\Has the Order Date been Dispatched"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\Foreach File Check that it isnt already Imported\Move Bad File to Archive and Rename" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 2]"
          DTS:CreationName=""
          DTS:DTSID="{DB5C2244-FB2E-4959-86CE-42A5D0A3C76E}"
          DTS:EvalOp="3"
          DTS:Expression="@[User::ImportStatus] != 0"
          DTS:From="Package\Foreach File Check that it isnt already Imported\Move Bad File to Archive and Rename"
          DTS:ObjectName="Constraint 2"
          DTS:To="Package\Foreach File Check that it isnt already Imported\Send Warning Email of Bad file" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 3]"
          DTS:CreationName=""
          DTS:DTSID="{F183ABFD-8C9F-4507-945A-DDDE9E7B3E40}"
          DTS:EvalOp="4"
          DTS:Expression="@[User::ImportStatus] == 0"
          DTS:From="Package\Foreach File Check that it isnt already Imported\Has the Order Date been Dispatched"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 3"
          DTS:To="Package\Foreach File Check that it isnt already Imported\Check Wave Type" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 4]"
          DTS:CreationName=""
          DTS:DTSID="{FDCFC4E8-412D-49C0-BC00-13A93FF1D97A}"
          DTS:EvalOp="1"
          DTS:Expression="@[User::WaveType] == 1 &amp;&amp;  @[User::ImportStatus] == 0"
          DTS:From="Package\Foreach File Check that it isnt already Imported\Check Wave Type"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 4"
          DTS:To="Package\Foreach File Check that it isnt already Imported\Process Valid Dispatch Files" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 5]"
          DTS:CreationName=""
          DTS:DTSID="{DBE577AC-336C-4D2F-92A7-F23FA7EEF8AB}"
          DTS:EvalOp="1"
          DTS:Expression="@[User::WaveType] != 1"
          DTS:From="Package\Foreach File Check that it isnt already Imported\Check Wave Type"
          DTS:ObjectName="Constraint 5"
          DTS:To="Package\Foreach File Check that it isnt already Imported\Send Mail Task" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 7]"
          DTS:CreationName=""
          DTS:DTSID="{60B894A5-EB63-4E47-9666-D55FC6364CE2}"
          DTS:From="Package\Foreach File Check that it isnt already Imported\Send Mail Task"
          DTS:ObjectName="Constraint 7"
          DTS:To="Package\Foreach File Check that it isnt already Imported\Move Bad File to Archive and Rename" />
      </DTS:PrecedenceConstraints>
      <DTS:ForEachVariableMappings>
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{F9C87F4E-42E5-4209-9DBF-65C0B043D9D7}"
          DTS:ObjectName="{F9C87F4E-42E5-4209-9DBF-65C0B043D9D7}"
          DTS:ValueIndex="0"
          DTS:VariableName="User::DispatchFilename" />
      </DTS:ForEachVariableMappings>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Foreach Region check that the Dispatch file has been processed"
      DTS:CreationName="STOCK:FOREACHLOOP"
      DTS:Description="Foreach Loop Container"
      DTS:DTSID="{F294A39C-4B9D-4117-BF11-00C195120B3F}"
      DTS:ExecutableType="STOCK:FOREACHLOOP"
      DTS:LocaleID="-1"
      DTS:ObjectName="Foreach Region check that the Dispatch file has been processed">
      <DTS:ForEachEnumerator
        DTS:CreationName="Microsoft.ForEachADOEnumerator"
        DTS:DTSID="{EA15EB61-A620-49C5-964F-2A0D944B4485}"
        DTS:ObjectName="{F84796D8-11F5-4F8E-89FB-015E9725C7F8}">
        <DTS:ObjectData>
          <FEEADO
            EnumType="EnumerateRowsInFirstTable"
            VarName="User::RegionList" />
        </DTS:ObjectData>
      </DTS:ForEachEnumerator>
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Foreach Region check that the Dispatch file has been processed\Is it a Shipping Day and is a Bakery Wav file Late"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{C83747C2-BD85-41B2-8372-E6D8A0155E4D}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Is it a Shipping Day and is a Bakery Wav file Late"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{8914C185-EC6E-4AB3-B9F1-DEF1E51955D2}"
              SQLTask:SqlStatementSource="&#xA;--Has a file been processed by 10pm&#xA;Declare @RegionalBakery as varchar(20) = ?&#xA;Declare @OrderDate as varchar(10) = ?&#xA;&#xA;--Declare @RegionalBakery as varchar(20) = 'POR-DAVIS'&#xA;--Declare @OrderDate as varchar(10) = '2020-09-29'&#xA;&#xA;select Top 1&#xA;&#x9;X.[ImportStatus] as 'ImportStatus'&#xA;From (SELECT Distinct&#xA;&#x9;case when [ImportDateTime] is NULL and cast(getdate() as time) between cast('22:00:00' as time) and cast('22:35:00' as time)&#xA;&#x9;&#x9;&#x9;then 'LATE'&#xA;&#x9;&#x9;else 'GOOD'&#xA;&#x9;&#x9;end as 'ImportStatus'&#xA;  FROM [dbo].[PC_Data_ImportExport_Monitor]&#xA;&#xA;  where [RegionalBakery] = @RegionalBakery&#xA;&#x9;and [OrderDate] = @OrderDate&#xA;&#x9;and [ImportDateTime] is NULL&#xA;&#xA;&#x9;union select 'GOOD' as 'ImportStatus'&#xA;) as X&#xA;&#xA;Order by X.[ImportStatus]"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::DispatchStatus" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::Region"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::OrderDate"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Foreach Region check that the Dispatch file has been processed\Send LATE Mail Task"
          DTS:CreationName="Microsoft.SendMailTask"
          DTS:Description="Send Mail Task"
          DTS:DTSID="{1EDE0F68-27B9-4ED4-8291-13BC86782700}"
          DTS:ExecutableType="Microsoft.SendMailTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Send LATE Mail Task"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="CCLine">@[User::ErrorEmailCC]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[User::ErrorEmailFrom]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="MessageSource">"CALL Shipping Department at Bakery " + @[User::Region] + "

The Shipping Dispatch File for " + @[User::Region] + " has not been Received by 10PM Pacific time.  The Shipping Adjustments needed for the Sales Handhelds will not get the correct information.

&lt;" +  @[System::MachineName] + ", PCDATA_Dispatched_Orders_PROD, " +  @[System::PackageName] + "&gt;"</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">"CRITICAL - Business Systems - PC_DATA - Shipping Dispatch File is LATE for Bakery " + @[User::Region]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[User::EmailSuccessTo]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{710979CD-AC2F-4F05-9D13-F7EE02B86A87}"
              SendMailTask:From="SSIS_Svc@usbakery.com"
              SendMailTask:To="paul.cardon@usbakery.com;max.schneider@usbakery.com"
              SendMailTask:CC="paul.cardon@usbakery.com;max.schneider@usbakery.com"
              SendMailTask:Subject="CRITICAL - Business Systems - PC_DATA - Shipping Dispatch File is LATE for Bakery POR-DAVIS"
              SendMailTask:MessageSource="CALL Shipping Department at Bakery POR-DAVIS&#xA;&#xA;The Shipping Dispatch File for POR-DAVIS has not been Received by 10PM Pacific time.  The Shipping Adjustments needed for the Sales Handhelds will not get the correct information.&#xA;&#xA;&lt;LAP31893, PCDATA_Dispatched_Orders_PROD, PCData_Route_GetDispatchedOrders_v6&gt;" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Foreach Region check that the Dispatch file has been processed\Send Mail Task"
          DTS:CreationName="Microsoft.SendMailTask"
          DTS:Description="Send Mail Task"
          DTS:Disabled="True"
          DTS:DTSID="{6FE0CB86-EF7C-403E-B00F-87F255821445}"
          DTS:ExecutableType="Microsoft.SendMailTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Send Mail Task"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="CCLine">@[User::ErrorEmailCC]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[User::ErrorEmailFrom]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="MessageSource">@[User::EmailSuccessBody]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">@[User::EmailSuccessSubject]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[User::EmailSuccessTo]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{710979CD-AC2F-4F05-9D13-F7EE02B86A87}"
              SendMailTask:From="SSIS_Svc@usbakery.com"
              SendMailTask:To="paul.cardon@usbakery.com;max.schneider@usbakery.com"
              SendMailTask:CC="paul.cardon@usbakery.com;max.schneider@usbakery.com"
              SendMailTask:Subject="INFO - Business Systems - PC_DATA - Shipping Dispatch File Import for Bakery POR-DAVIS"
              SendMailTask:MessageSource="Shipping Dispatch File 20240130_1_1_BIL-MIDLND.OD0 has Imported for Bakery POR-DAVIS&#xA;&#xA;&lt;LAP31893, Old_Handheld_Exports - ALL Divisions PROD, PCData_Route_GetDispatchedOrders_v6&gt;" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Foreach Region check that the Dispatch file has been processed.PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{DA646645-A252-4606-A913-D150D34FFA73}"
          DTS:EvalOp="3"
          DTS:Expression="UPPER(@[User::DispatchStatus]) == &quot;LATE&quot;"
          DTS:From="Package\Foreach Region check that the Dispatch file has been processed\Is it a Shipping Day and is a Bakery Wav file Late"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\Foreach Region check that the Dispatch file has been processed\Send Mail Task" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Foreach Region check that the Dispatch file has been processed.PrecedenceConstraints[Constraint 2]"
          DTS:CreationName=""
          DTS:DTSID="{2FFAFA64-7154-4D73-9D4D-C486195ADF13}"
          DTS:EvalOp="3"
          DTS:Expression="UPPER(@[User::DispatchStatus]) == &quot;LATE&quot;"
          DTS:From="Package\Foreach Region check that the Dispatch file has been processed\Is it a Shipping Day and is a Bakery Wav file Late"
          DTS:ObjectName="Constraint 2"
          DTS:To="Package\Foreach Region check that the Dispatch file has been processed\Send LATE Mail Task" />
      </DTS:PrecedenceConstraints>
      <DTS:ForEachVariableMappings>
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{4E3752DB-2A69-41E7-AF4B-288DBF519A38}"
          DTS:ObjectName="{1C9E564A-CAB6-4328-B0CC-55189A8AF9F8}"
          DTS:ValueIndex="0"
          DTS:VariableName="User::Region" />
      </DTS:ForEachVariableMappings>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Get Active Regional Bakeries"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{92D5A7C6-9EC2-44BB-8265-5D7D5E762D2B}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Get Active Regional Bakeries">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Get Active Regional Bakeries\Admin table missing"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{7C9E99E9-67ED-49E7-A40A-7B8081EC62AC}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Admin table missing"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{8914C185-EC6E-4AB3-B9F1-DEF1E51955D2}"
              SQLTask:SqlStatementSource="IF OBJECT_ID (N'PC_Data_Administration', N'U') IS NULL &#xA;CREATE TABLE [dbo].[PC_Data_Administration](&#xA;&#x9;[DivisionCode] [varchar](50) NOT NULL,&#xA;&#x9;[ShipOrderDirectory] [varchar](200) NULL,&#xA;&#x9;[DispatchDirectory] [varchar](200) NULL,&#xA;&#x9;[Inactive] [int] NULL&#xA;) ON [PRIMARY]&#xA;go&#xA;&#xA;IF OBJECT_ID (N'PCData_Admin_Inactive0') IS NULL&#xA;ALTER TABLE [dbo].[PC_Data_Administration] ADD  CONSTRAINT [PCData_Admin_Inactive0]  DEFAULT ((0)) FOR [Inactive]&#xA;go" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Get Active Regional Bakeries\Get All Active Regional Bakeries"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{927A5BEB-6C83-4F9B-8794-E76A97EEB415}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Get All Active Regional Bakeries"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{8914C185-EC6E-4AB3-B9F1-DEF1E51955D2}"
              SQLTask:SqlStatementSource="-- Get Active Regional Bakeries&#xA;Declare @RegionalBakery as varchar(20) = ?&#xA;--Declare @RegionalBakery as varchar(20) = ''  -- 'POR-DAVIS'&#xA;&#xA;SELECT [RegionalBakery]&#xA;&#x9;FROM [dbo].[PC_Data_Administration]&#xA;&#x9;where [Inactive] = 0&#xA;&#x9;&#x9;and [DispatchDirectory] is not null&#xA;&#x9;&#x9;and [RegionalBakery] like case when CHARINDEX('-', @RegionalBakery, 2) = 0&#xA;&#x9;&#x9;&#x9;&#x9;Then [RegionalBakery]&#xA;&#x9;&#x9;&#x9;&#x9;else @RegionalBakery&#xA;&#x9;&#x9;&#x9;&#x9;end&#xA;"
              SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::RegionList" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="$Package::RegionalBakery"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Get Active Regional Bakeries\Send Error Email"
          DTS:CreationName="Microsoft.SendMailTask"
          DTS:Description="Send Mail Task"
          DTS:DTSID="{86FA5678-9CD8-4C7B-A5FD-93C2AB0C5143}"
          DTS:ExecutableType="Microsoft.SendMailTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Send Error Email"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="CCLine">@[User::ErrorEmailCC]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[User::ErrorEmailFrom]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="MessageSource">"CALL Business Systems.
The function 'Get All Active Divisions' returned 0 rows.  On server '" +  @[User::DB_Support_Server] + "', database '" +  @[User::DB_Support_Database] + "', the  table  [PC_Data_Administration] does not contain any active Divisions.

Contact the Business System Analyst Group to Validate that the table has active Divisions listed.

&lt;" +  @[System::MachineName] + ", Old_Handheld_Exports - ALL Divisions PROD, " +  @[System::PackageName] + "&gt;"</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">"CRITICAL - Business Systems - PC_DATA - Dispatch Files Failed to Process"</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[User::ErrorEmailTo]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{710979CD-AC2F-4F05-9D13-F7EE02B86A87}"
              SendMailTask:From="SSIS_Svc@usbakery.com"
              SendMailTask:To="paul.cardon@usbakery.com;max.schneider@usbakery.com"
              SendMailTask:CC="paul.cardon@usbakery.com;max.schneider@usbakery.com"
              SendMailTask:Subject="CRITICAL - Business Systems - PC_DATA - Dispatch Files Failed to Process"
              SendMailTask:Priority="High"
              SendMailTask:MessageSource="CALL Business Systems.&#xA;The function 'Get All Active Divisions' returned 0 rows.  On server 'testnav120', database 'USB-Support', the  table  [PC_Data_Administration] does not contain any active Divisions.&#xA;&#xA;Contact the Business System Analyst Group to Validate that the table has active Divisions listed.&#xA;&#xA;&lt;LAP31893, Old_Handheld_Exports - ALL Divisions PROD, PCData_Route_GetDispatchedOrders_v6&gt;" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Get Active Regional Bakeries\Trim Monitor Table"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{72FD575E-B1FF-4DF2-8FC8-0B0FBD1212D1}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Trim Monitor Table"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{8914C185-EC6E-4AB3-B9F1-DEF1E51955D2}"
              SQLTask:SqlStatementSource="&#xA;IF OBJECT_ID (N'PC_Data_ImportExport_Monitor', N'U') IS NULL &#xA;begin&#xA;CREATE TABLE [dbo].[PC_Data_ImportExport_Monitor](&#xA;&#x9;[RegionalBakery] [nvarchar](30) NOT NULL,&#xA;&#x9;[OrderDate] [date] NOT NULL,&#xA;&#x9;[ShippingDate] [date] NOT NULL,&#xA;&#x9;[ProductionDate] [date] NOT NULL,&#xA;&#x9;[ExportFileDateTime] [datetime] NULL,&#xA;&#x9;[ExecutionType] [nvarchar](20) NULL,&#xA;&#x9;[ImportDateTime] [datetime] NULL,&#xA;&#x9;[ReceiveType] [nvarchar](50) NULL,&#xA;&#x9;[ReceivedFile] [nvarchar](150) NULL&#xA;) ON [PRIMARY]&#xA;end&#xA;ELSE&#xA;begin&#xA;Delete from [dbo].[PC_Data_ImportExport_Monitor]&#xA;&#x9;where [OrderDate] &lt; DATEADD(dd,-30,getdate())&#xA;end&#xA;go" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Get Active Regional Bakeries\Validate Active Bakeries"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{4EA4F712-9438-482A-B8DC-A282474816C1}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Validate Active Bakeries"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{8914C185-EC6E-4AB3-B9F1-DEF1E51955D2}"
              SQLTask:SqlStatementSource="SELECT Count(*) as 'RowCount'&#xA; FROM [dbo].[PC_Data_Administration]&#xA;&#xA;  where [Inactive] = 0&#xA;&#x9;and [DispatchDirectory] is not null"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="RowCount"
                SQLTask:DtsVariableName="User::DivisionAdminCnt" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Get Active Regional Bakeries.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{C19B00FE-42BB-4D69-B30A-5D9F66879EE4}"
          DTS:From="Package\Get Active Regional Bakeries\Admin table missing"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\Get Active Regional Bakeries\Validate Active Bakeries" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Get Active Regional Bakeries.PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{AAB9E201-7679-4AFE-BF11-0EF510F6C536}"
          DTS:EvalOp="3"
          DTS:Expression="@[User::DivisionAdminCnt] == 0"
          DTS:From="Package\Get Active Regional Bakeries\Validate Active Bakeries"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package\Get Active Regional Bakeries\Send Error Email" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Get Active Regional Bakeries.PrecedenceConstraints[Constraint 2]"
          DTS:CreationName=""
          DTS:DTSID="{BE0EA37B-88B0-4887-B4EC-B730A6B862D8}"
          DTS:EvalOp="3"
          DTS:Expression="@[User::DivisionAdminCnt] != 0"
          DTS:From="Package\Get Active Regional Bakeries\Validate Active Bakeries"
          DTS:ObjectName="Constraint 2"
          DTS:To="Package\Get Active Regional Bakeries\Get All Active Regional Bakeries" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Get Active Regional Bakeries.PrecedenceConstraints[Constraint 3]"
          DTS:CreationName=""
          DTS:DTSID="{2C9DE000-9D6F-4760-B17A-587CA901CA15}"
          DTS:From="Package\Get Active Regional Bakeries\Trim Monitor Table"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 3"
          DTS:To="Package\Get Active Regional Bakeries\Admin table missing" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{0CA351A8-EEC1-4F0A-92E6-2019F3D5F040}"
      DTS:EvalOp="3"
      DTS:Expression="@[User::DivisionAdminCnt] != 0"
      DTS:From="Package\Get Active Regional Bakeries"
      DTS:ObjectName="Constraint"
      DTS:To="Package\For Each Regional Bakery Move Dispatch Files" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{8EEE96B1-89FF-44E6-9C1F-BE730E63BEC6}"
      DTS:From="Package\Foreach File Check that it isnt already Imported"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Foreach Region check that the Dispatch file has been processed" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{951F1A30-96A4-4042-BA06-721B9C50BAC5}"
      DTS:From="Package\For Each Regional Bakery Move Dispatch Files"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Foreach File Check that it isnt already Imported" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{B8D8754F-C613-4A99-B635-4B03C5022927}"
      DTS:EventID="464961400"
      DTS:EventName="OnError"
      DTS:FailPackageOnFailure="True"
      DTS:FailParentOnFailure="True"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{18EECC6D-74E5-4E98-902C-6BEAA0216056}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\Email Package Failed"
          DTS:CreationName="Microsoft.SendMailTask"
          DTS:Description="Send Mail Task"
          DTS:DTSID="{5627EFFA-9734-42A7-933C-3621F34DBA1F}"
          DTS:ExecutableType="Microsoft.SendMailTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Email Package Failed"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="CCLine">@[User::ErrorEmailCC]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[User::ErrorEmailFrom]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="MessageSource">"CALL Business Systems.
PC-Data Dispatch file Import to NAV Failed.  This is a Critical error and must be correct prior to 10:30pm Pacific time or the Sales Handhelds will not recieve their Order Adjustments for the next sales day.

Failure Description: " +  @[System::ErrorDescription] + "



&lt;" +  @[System::MachineName] + ", PCDATA_Dispatched_Orders_PROD, " +  @[System::PackageName] + "&gt;"</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">"CRITICAL - Business Systems - PC_DATA - Dispatch Files Failed to Process"</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[User::ErrorEmailTo]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{BE713657-DD38-46EE-9E28-FF6BAFD45F91}"
              SendMailTask:From="SSIS_Svc@usbakery.com"
              SendMailTask:To="paul.cardon@usbakery.com;max.schneider@usbakery.com"
              SendMailTask:CC="paul.cardon@usbakery.com;max.schneider@usbakery.com"
              SendMailTask:Subject="CRITICAL - Business Systems - PC_DATA - Dispatch Files Failed to Process"
              SendMailTask:MessageSource="CALL Business Systems.&#xA;PC-Data Dispatch file Import to NAV Failed.  This is a Critical error and must be correct prior to 10:30pm Pacific time or the Sales Handhelds will not recieve their Order Adjustments for the next sales day.&#xA;&#xA;Failure Description: &#xA;&#xA;&#xA;&#xA;&lt;LAP31893, PCDATA_Dispatched_Orders_PROD, PCData_Route_GetDispatchedOrders_v6&gt;" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\Expression Task"
          DTS:CreationName="Microsoft.ExpressionTask"
          DTS:Description="Expression Task"
          DTS:DTSID="{488F5CF9-F5AC-4AB6-91CD-A6F347985EDB}"
          DTS:ExecutableType="Microsoft.ExpressionTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Expression Task"
          DTS:TaskContact="Expression Task;Microsoft Corporation; SQL Server 2012; � 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <ExpressionTask
              Expression="@[System::SourceID] ==  @[System::PackageID]" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint 1]"
          DTS:CreationName=""
          DTS:DTSID="{EB16314E-AEE8-4A9A-A89B-EC63F119AE83}"
          DTS:EvalOp="3"
          DTS:Expression="@[System::PackageID] ==  @[System::SourceID]"
          DTS:From="Package.EventHandlers[OnError]\Expression Task"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint 1"
          DTS:To="Package.EventHandlers[OnError]\Email Package Failed" />
      </DTS:PrecedenceConstraints>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="252,41.6"
          Id="Package\For Each Regional Bakery Move Dispatch Files\Move Wave or EOD File to Process"
          TopLeft="32,64" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="315.2,167.2"
          Size="315.2,209.6"
          Id="Package\For Each Regional Bakery Move Dispatch Files"
          TopLeft="215.944444444444,385.944444444444" />
        <NodeLayout
          Size="168.8,41.6"
          Id="Package\Foreach File Check that it isnt already Imported\Check Wave Type"
          TopLeft="430,145" />
        <NodeLayout
          Size="214.4,41.6"
          Id="Package\Foreach File Check that it isnt already Imported\Get File Dispatch Order Date"
          TopLeft="320,8.49999999999989" />
        <NodeLayout
          Size="252,41.6"
          Id="Package\Foreach File Check that it isnt already Imported\Has the Order Date been Dispatched"
          TopLeft="302,59.5" />
        <NodeLayout
          Size="267.2,41.6"
          Id="Package\Foreach File Check that it isnt already Imported\Move Bad File to Archive and Rename"
          TopLeft="3.5,241.5" />
        <NodeLayout
          Size="217.6,41.6"
          Id="Package\Foreach File Check that it isnt already Imported\Process Valid Dispatch Files"
          TopLeft="413.833333300219,216.233333347109" />
        <NodeLayout
          Size="155.2,41.6"
          Id="Package\Foreach File Check that it isnt already Imported\Send Mail Task"
          TopLeft="210,175" />
        <NodeLayout
          Size="224.8,41.6"
          Id="Package\Foreach File Check that it isnt already Imported\Send Warning Email of Bad file"
          TopLeft="21.5,311.5" />
        <EdgeLayout
          Id="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint]"
          TopLeft="320,29.4999999999999">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-18,51.0000000000001"
              Start="0,0"
              End="-25.5,51.0000000000001">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-36.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="-36.5,0"
                    Point2="-40.5,0"
                    Point3="-40.5,4" />
                  <mssgle:LineSegment
                    End="-40.5,47.0000000000001" />
                  <mssgle:CubicBezierSegment
                    Point1="-40.5,47.0000000000001"
                    Point2="-40.5,51.0000000000001"
                    Point3="-36.5,51.0000000000001" />
                  <mssgle:LineSegment
                    End="-25.5,51.0000000000001" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 1]"
          TopLeft="387.333333333333,101.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-207.166666666667,140"
              Start="0,0"
              End="-207.166666666667,132.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,66.0307368051286" />
                  <mssgle:CubicBezierSegment
                    Point1="0,66.0307368051286"
                    Point2="0,70.0307368051286"
                    Point3="-4,70.0307368051286" />
                  <mssgle:LineSegment
                    End="-203.166666666667,70.0307368051286" />
                  <mssgle:CubicBezierSegment
                    Point1="-203.166666666667,70.0307368051286"
                    Point2="-207.166666666667,70.0307368051286"
                    Point3="-207.166666666667,74.0307368051286" />
                  <mssgle:LineSegment
                    End="-207.166666666667,132.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-111.583333333333,75.0307368051286,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 2]"
          TopLeft="135.5,283.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,28"
              Start="0,0"
              End="0,20.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,20.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-8,2.25,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 3]"
          TopLeft="468.666666666667,101.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="45.8333333333334,43.5"
              Start="0,0"
              End="45.8333333333334,36">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,14.5646687697161" />
                  <mssgle:CubicBezierSegment
                    Point1="0,14.5646687697161"
                    Point2="0,18.5646687697161"
                    Point3="4,18.5646687697161" />
                  <mssgle:LineSegment
                    End="41.8333333333334,18.5646687697161" />
                  <mssgle:CubicBezierSegment
                    Point1="41.8333333333334,18.5646687697161"
                    Point2="45.8333333333334,18.5646687697161"
                    Point3="45.8333333333334,22.5646687697161" />
                  <mssgle:LineSegment
                    End="45.8333333333334,36" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="14.9166666666667,23.5646687697161,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 4]"
          TopLeft="514.4,186.6">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8.23333330021944,29.6333333471086"
              Start="0,0"
              End="8.23333330021944,22.1333333471086">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,10.8166666735543" />
                  <mssgle:CubicBezierSegment
                    Point1="0,10.8166666735543"
                    Point2="0,14.8166666735543"
                    Point3="4,14.8166666735543" />
                  <mssgle:LineSegment
                    End="4.23333330021944,14.8166666735543" />
                  <mssgle:CubicBezierSegment
                    Point1="4.23333330021944,14.8166666735543"
                    Point2="8.23333330021944,14.8166666735543"
                    Point3="8.23333330021944,18.8166666735543" />
                  <mssgle:LineSegment
                    End="8.23333330021944,22.1333333471086" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-3.88333334989028,19.8166666735543,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 5]"
          TopLeft="430,166">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-65,30"
              Start="0,0"
              End="-57.5,30">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-28.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="-28.5,0"
                    Point2="-32.5,0"
                    Point3="-32.5,4" />
                  <mssgle:LineSegment
                    End="-32.5,26" />
                  <mssgle:CubicBezierSegment
                    Point1="-32.5,26"
                    Point2="-32.5,30"
                    Point3="-36.5,30" />
                  <mssgle:LineSegment
                    End="-57.5,30" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-40.5,-22,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Foreach File Check that it isnt already Imported.PrecedenceConstraints[Constraint 7]"
          TopLeft="287.5,217">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-193.666666666667,24.5"
              Start="0,0"
              End="-193.666666666667,17">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,10.6124348473567" />
                  <mssgle:CubicBezierSegment
                    Point1="0,10.6124348473567"
                    Point2="0,14.6124348473567"
                    Point3="-4,14.6124348473567" />
                  <mssgle:LineSegment
                    End="-189.666666666667,14.6124348473567" />
                  <mssgle:CubicBezierSegment
                    Point1="-189.666666666667,14.6124348473567"
                    Point2="-193.666666666667,14.6124348473567"
                    Point3="-193.666666666667,18.6124348473567" />
                  <mssgle:LineSegment
                    End="-193.666666666667,17" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="659.2,432"
          Size="659.2,475.2"
          Id="Package\Foreach File Check that it isnt already Imported"
          TopLeft="542.833333333334,14.1666666666667" />
        <NodeLayout
          Size="311.2,41.6"
          Id="Package\Foreach Region check that the Dispatch file has been processed\Is it a Shipping Day and is a Bakery Wav file Late"
          TopLeft="149,7.5" />
        <NodeLayout
          Size="176.8,41.6"
          Id="Package\Foreach Region check that the Dispatch file has been processed\Send LATE Mail Task"
          TopLeft="216,107.5" />
        <NodeLayout
          Size="150.4,41.6"
          Id="Package\Foreach Region check that the Dispatch file has been processed\Send Mail Task"
          TopLeft="5.5,107.5" />
        <EdgeLayout
          Id="Package\Foreach Region check that the Dispatch file has been processed.PrecedenceConstraints[Constraint 1]"
          TopLeft="254,49.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-173.5,58"
              Start="0,0"
              End="-173.5,50.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.3781190019194" />
                  <mssgle:CubicBezierSegment
                    Point1="0,19.3781190019194"
                    Point2="0,23.3781190019194"
                    Point3="-4,23.3781190019194" />
                  <mssgle:LineSegment
                    End="-169.5,23.3781190019194" />
                  <mssgle:CubicBezierSegment
                    Point1="-169.5,23.3781190019194"
                    Point2="-173.5,23.3781190019194"
                    Point3="-173.5,27.3781190019194" />
                  <mssgle:LineSegment
                    End="-173.5,50.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-94.75,28.3781190019194,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Foreach Region check that the Dispatch file has been processed.PrecedenceConstraints[Constraint 2]"
          TopLeft="355,49.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-50.5,58"
              Start="0,0"
              End="-50.5,50.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.3781190019194" />
                  <mssgle:CubicBezierSegment
                    Point1="0,19.3781190019194"
                    Point2="0,23.3781190019194"
                    Point3="-4,23.3781190019194" />
                  <mssgle:LineSegment
                    End="-46.5,23.3781190019194" />
                  <mssgle:CubicBezierSegment
                    Point1="-46.5,23.3781190019194"
                    Point2="-50.5,23.3781190019194"
                    Point3="-50.5,27.3781190019194" />
                  <mssgle:LineSegment
                    End="-50.5,50.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-33.25,28.3781190019194,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="465.6,204.8"
          Size="465.6,248"
          Id="Package\Foreach Region check that the Dispatch file has been processed"
          TopLeft="1299.16666666667,19.7222222222223" />
        <NodeLayout
          Size="174.4,41.6"
          Id="Package\Get Active Regional Bakeries\Admin table missing"
          TopLeft="249.277777777778,74.1666666666667" />
        <NodeLayout
          Size="228,41.6"
          Id="Package\Get Active Regional Bakeries\Get All Active Regional Bakeries"
          TopLeft="223.388888888889,220.388888888889" />
        <NodeLayout
          Size="158.4,41.6"
          Id="Package\Get Active Regional Bakeries\Send Error Email"
          TopLeft="11.0555555555556,213.722222222222" />
        <NodeLayout
          Size="168.8,41.6"
          Id="Package\Get Active Regional Bakeries\Trim Monitor Table"
          TopLeft="254,8.5" />
        <NodeLayout
          Size="191.2,41.6"
          Id="Package\Get Active Regional Bakeries\Validate Active Bakeries"
          TopLeft="238.555555555556,142.833333333333" />
        <EdgeLayout
          Id="Package\Get Active Regional Bakeries.PrecedenceConstraints[Constraint]"
          TopLeft="335.166666666667,116.166666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,26.6666666666667"
              Start="0,0"
              End="0,19.1666666666667">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.1666666666667" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Get Active Regional Bakeries.PrecedenceConstraints[Constraint 1]"
          TopLeft="303.555555555556,184.833333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-213.5,28.8888888888889"
              Start="0,0"
              End="-213.5,21.3888888888889">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,7.69955001730702" />
                  <mssgle:CubicBezierSegment
                    Point1="0,7.69955001730702"
                    Point2="0,11.699550017307"
                    Point3="-4,11.699550017307" />
                  <mssgle:LineSegment
                    End="-209.5,11.699550017307" />
                  <mssgle:CubicBezierSegment
                    Point1="-209.5,11.699550017307"
                    Point2="-213.5,11.699550017307"
                    Point3="-213.5,15.699550017307" />
                  <mssgle:LineSegment
                    End="-213.5,21.3888888888889" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-114.75,16.699550017307,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Get Active Regional Bakeries.PrecedenceConstraints[Constraint 2]"
          TopLeft="364.555555555556,184.833333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-27.1666666666667,35.5555555555556"
              Start="0,0"
              End="-27.1666666666667,28.0555555555556">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,10.3994461751471" />
                  <mssgle:CubicBezierSegment
                    Point1="0,10.3994461751471"
                    Point2="0,14.3994461751471"
                    Point3="-4,14.3994461751471" />
                  <mssgle:LineSegment
                    End="-23.1666666666667,14.3994461751471" />
                  <mssgle:CubicBezierSegment
                    Point1="-23.1666666666667,14.3994461751471"
                    Point2="-27.1666666666667,14.3994461751471"
                    Point3="-27.1666666666667,18.3994461751471" />
                  <mssgle:LineSegment
                    End="-27.1666666666667,28.0555555555556" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-21.5833333333334,19.3994461751471,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Get Active Regional Bakeries.PrecedenceConstraints[Constraint 3]"
          TopLeft="337.388888888889,50.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,23.6666666666667"
              Start="0,0"
              End="0,16.1666666666667">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.1666666666667" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="457.6,316.8"
          Size="457.6,360"
          Id="Package\Get Active Regional Bakeries"
          TopLeft="15.8333333333333,5.72222222222217" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="473.833333333333,185.722222222222">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-151.555555555556,200.222222222222"
              Start="0,0"
              End="-151.555555555556,192.722222222222">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-147.555555555556,0" />
                  <mssgle:CubicBezierSegment
                    Point1="-147.555555555556,0"
                    Point2="-151.555555555556,0"
                    Point3="-151.555555555556,4" />
                  <mssgle:LineSegment
                    End="-151.555555555556,192.722222222222" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-159.555555555556,-22,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="1202.03333333333,251.766666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="97.1333333333357,-108.044444444444"
              Start="0,0"
              End="89.6333333333357,-108.044444444444">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="44.5666666666679,0" />
                  <mssgle:CubicBezierSegment
                    Point1="44.5666666666679,0"
                    Point2="48.5666666666679,0"
                    Point3="48.5666666666679,-4" />
                  <mssgle:LineSegment
                    End="48.5666666666679,-104.044444444444" />
                  <mssgle:CubicBezierSegment
                    Point1="48.5666666666679,-104.044444444444"
                    Point2="48.5666666666679,-108.044444444444"
                    Point3="52.5666666666679,-108.044444444444" />
                  <mssgle:LineSegment
                    End="89.6333333333357,-108.044444444444" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="424.744444444444,385.944444444444">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="118.08888888889,-134.177777777777"
              Start="0,0"
              End="110.58888888889,-134.177777777777">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-130.177777777777" />
                  <mssgle:CubicBezierSegment
                    Point1="0,-130.177777777777"
                    Point2="0,-134.177777777777"
                    Point3="4,-134.177777777777" />
                  <mssgle:LineSegment
                    End="110.58888888889,-134.177777777777" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="177,42"
          Id="Package.EventHandlers[OnError]\Email Package Failed"
          TopLeft="47,88" />
        <NodeLayout
          Size="155,42"
          Id="Package.EventHandlers[OnError]\Expression Task"
          TopLeft="63,5" />
        <EdgeLayout
          Id="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint 1]"
          TopLeft="138,47">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,41"
              Start="0,0"
              End="0,33.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,33.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-8,8.75,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>